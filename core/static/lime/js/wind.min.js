function slide(){var e=$("#drop-cat ul");$["class"].has($("#drop-cat"),"open")?(e.style.height="0",$["class"].remove($("#drop-cat"),"open")):(e.style.height=(56*$("#drop-cat ul").children.length).toString()+"px",$["class"].add($("#drop-cat"),"open"))}function change(){se.getItem("index")&&se.getItem("current")&&(audio.currentTime=parseFloat(se.getItem("current")))}function initPlayer(e){audio.setAttribute("src",musicList[e].Source),$(".song").innerHTML=musicList[e].Title,$(".album").innerHTML=musicList[e].Album,$(".progress").style.width="0px",audio.removeEventListener("canplay",bufferBar,!1),clearInterval(bufferTimer),$(".buffer").style.width="0px"}function toPlay(e){"play"==e?(audio.play(),removeClass($(".pause"),"hidden"),addClass($(".play"),"hidden"),se.setItem("pause",0)):"pause"==e?(audio.pause(),removeClass($(".play"),"hidden"),addClass($(".pause"),"hidden"),se.setItem("pause",1)):"prev"==e?playMusicMode(e):"next"==e&&playMusicMode(e)}function playMusicMode(e){var t=musicList.length,i=musicIndex;if("list"==musicMode&&("prev"==e?1==i?i=t:i-=1:("next"==e||"ended"==e)&&(i==t?i=1:i+=1)),"shuffle"==musicMode){var n=parseInt(t*Math.random());i=n+1}musicIndex=i,playIndex(i-1)}function playIndex(e){initPlayer(e),audio.load(),audio.addEventListener("canplay",bufferBar,!1),toPlay("play"),se.setItem("index",e+1)}function changeMusicMode(e,t){musicMode=t,"shuffle"==musicMode?e.style.color="#8BC34A":e.style.color="#A1A1A1",se.setItem("mode",t)}function bufferBar(){bufferTimer=setInterval(function(){var e=audio.buffered.length;if(e>0&&void 0!=audio.buffered){var t=audio.buffered.end(e-1)/audio.duration*324;$(".buffer").style.width=parseInt(t)+"px",Math.abs(audio.duration-audio.buffered.end(e-1))<1&&($(".buffer").style.width="324px",clearInterval(bufferTimer))}},1e3)}function adjustPorgress(e,t){var i=window.event||t,n=i.clientX-e.getBoundingClientRect().left;audio.currentTime=parseInt(n/324*audio.duration),audio.removeEventListener("canplay",bufferBar,!1)}function adjustVolume(e,t){var i=window.event||t,n=e.getBoundingClientRect().bottom-i.clientY;audio.volume=(n/80).toFixed(2),$(".volume_now").style.height=n+"px",se.setItem("volume",(n/80).toFixed(2))}function adjustplay(e){audio.currentTime=parseFloat(e),audio.removeEventListener("canplay",bufferBar,!1)}function hasClass(e,t){for(var n,i=e.className.split(" "),o=0;o<i.length;o++){if(i[o]==t){n=!0;break}n=!1}return n}function addClass(e,t){hasClass(e,t)||(e.className+=" "+t)}function removeClass(e,t){if(hasClass(e,t))for(var i=e.className.split(" "),n=0;n<i.length;n++)if(i[n]==t){i.splice(n,1),e.className=i.join(" ");break}}function replaceClass(e,t,i){if(hasClass(e,t))for(var n=e.className.split(" "),o=0;o<n.length;o++)if(n[o]==t){n.splice(o,1,i),e.className=t.join(" ");break}}function playMusic(e){toPlay("pause"),hasClass($("#music"),"hidden")&&removeClass($("#music"),"hidden"),audio.setAttribute("src",e.Source),$(".song").innerHTML=e.Title,$(".album").innerHTML=e.Album,$(".progress").style.width="0px",audio.removeEventListener("canplay",bufferBar,!1),clearInterval(bufferTimer),$(".buffer").style.width="0px"}function fnDrafting(e,t){e.onmousedown=function(e){var i=e||event,n=i.clientX-t.offsetLeft,o=i.clientY-t.offsetTop;document.onmousemove=function(e){var i=e||event,a=i.clientX-n,s=i.clientY-o;0>a?a=0:a>document.documentElement.clientWidth-t.offsetWidth&&(a=document.documentElement.clientWidth-t.offsetWidth),0>s?s=0:s>document.documentElement.clientHeight-t.offsetHeight&&(s=document.documentElement.clientHeight-t.offsetHeight),t.style.left=a+"px",t.style.top=s+"px"},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}}}var musicList=[{Artist:"Suara",Album:"「Pure -AQUAPLUS LEGEND OF ACOUSTICS-」",Source:"https://dn-wind-moe.qbox.me/static/music/Suara - 梦想歌.mp3?ver=1.0",Title:"梦想歌",Duration:"247"},{Artist:"Suara",Title:"不安定な神様",Album:"「不安定な神様」",Source:"https://dn-wind-moe.qbox.me/static/music/Suara - 不安定な神様.mp3",Duration:"244"}],se=sessionStorage,audio=$("#audio");if(se.getItem("mode"))var musicMode=se.getItem("mode");else var musicMode="list";var bufferTimer=null,volumeTimer=null;if($(".play").onclick=function(){toPlay("play")},$(".pause").onclick=function(){toPlay("pause")},$(".prev").onclick=function(){toPlay("prev")},$(".next").onclick=function(){toPlay("next")},$(".progress_bar").onclick=function(e){adjustPorgress(this,e)},$(".volume").onmouseover=$(".volume_wrap").onmouseover=function(){clearTimeout(volumeTimer),removeClass($(".volume_wrap"),"hidden")},$(".volume").onmouseout=$(".volume_wrap").onmouseout=function(){volumeTimer=setTimeout(function(){addClass($(".volume_wrap"),"hidden")},300)},$(".volume_bar").onclick=function(e){adjustVolume(this,e)},$(".volume").onclick=function(){0==audio.muted?(this.style.color="#A1A1A1",audio.muted=!0,se.setItem("muted",1)):1==audio.muted&&(this.style.color="#8BC34A",audio.muted=!1,se.setItem("muted",0))},$(".shuffle").onclick=function(){"list"==musicMode?changeMusicMode(this,"shuffle"):changeMusicMode(this,"list")},audio.addEventListener("canplay",bufferBar,!1),audio.addEventListener("ended",function(){playMusicMode("ended")},!1),audio.addEventListener("timeupdate",function(){if(!isNaN(audio.duration)){sessionStorage.setItem("current",audio.currentTime);var e=parseInt(audio.currentTime/60),t=parseInt(audio.currentTime%60);10>t&&(t="0"+t);var i=parseInt(audio.duration/60),n=parseInt(audio.duration%60);10>n&&(n="0"+n),$(".time").innerHTML=e+":"+t+"/"+i+":"+n;var o=audio.currentTime/audio.duration*324;$(".progress").style.width=parseInt(o)+"px"}},!1),$(".dialog-close-button").onclick=function(){addClass($("#music"),"hidden")},$("#mbtn").onclick=function(){hasClass($("#music"),"hidden")?removeClass($("#music"),"hidden"):addClass($("#music"),"hidden")},se.setItem("mode","list"),se.getItem("index"))var musicIndex=parseInt(se.getItem("index"));else{var musicIndex=1;se.setItem("index",musicIndex)}se.getItem("volume")?(audio.volume=se.getItem("volume"),$(".volume_now").style.height=80*se.getItem("volume")+"px"):audio.volume=.5,se.getItem("pause")&&0==se.getItem("pause")&&(setTimeout(function(){audio.play(),change()},150),addClass($(".play"),"hidden"),removeClass($(".pause"),"hidden")),1==se.getItem("muted")&&($(".volume").style.color="#A1A1A1",audio.muted=!0);var oDiv=$("#music_drap"),oTag=$("#music");fnDrafting(oDiv,oTag),Title=document.title,document.addEventListener("visibilitychange",function(){var e=["╭(′▽`)╯","( ͡° ͜ʖ ͡°)","(ÒܫÓױ)","ヽ( ^∀^)ﾉ","(╯°□°)╯︵","(´・ω・`)","(`皿´)","(¬_¬)",'(￣▽￣)"',"(〒︿〒)"];document.hidden?(document.title=e[parseInt(10*Math.random(),10)]+" "+document.title,clearTimeout(2e3)):document.title=Title}),document.onkeydown=function(e){if(e||(e=window.event),13==(e.keyCode||e.which)){if(0===$("#search-field").value.length)return!1;window.location.href="/?search="+$("#search-field").value}},window.onload=function(){function e(e){for(var t=e.offsetTop;e=e.offsetParent;)t+=e.offsetTop;return t}function n(){var n=$(".container").scrollTop;~function(){i+n+1e3>e(t)&&comment()}()}if("function"==typeof comment){var t=$("#disqus_thread"),i=window.innerHeight;$(".container").addEventListener("scroll",n),n()}document.styleSheets[1].addRule(".drawer-header","background-image: url(/static/img/kuon.png);"),0!==document.body.querySelectorAll(".lazyload").length&&$.img.lazyload(),initPlayer(musicIndex-1)};