function slide(){var e=$("#drop-cat ul");$["class"].has($("#drop-cat"),"open")?(e.style.height="0",$["class"].remove($("#drop-cat"),"open")):(e.style.height=(56*$("#drop-cat ul").children.length).toString()+"px",$["class"].add($("#drop-cat"),"open"))}function slide_archive(e){var t=$('.archive-posts[data-month="'+e+'"]'),a=$('.archive-posts[data-month="'+e+'"] ul');$["class"].has(t,"open")?(a.style.height="0",$["class"].remove(t,"open")):(a.style.height=(24*a.children.length).toString()+"px",$["class"].add(t,"open"))}function change(){se.getItem("index")&&se.getItem("current")&&(audio.currentTime=parseFloat(se.getItem("current")))}function initPlayer(e){audio.setAttribute("src",musicList[e].Source),$(".song").innerHTML=musicList[e].Title,$(".album").innerHTML=musicList[e].Album,changePorgress($(".progress"),0)}function toPlay(e){"play"==e?(audio.play(),removeClass($(".pause"),"hidden"),addClass($(".play"),"hidden"),se.setItem("pause",0)):"pause"==e?(audio.pause(),removeClass($(".play"),"hidden"),addClass($(".pause"),"hidden"),se.setItem("pause",1)):"prev"==e?playMusicMode(e):"next"==e&&playMusicMode(e)}function playMusicMode(e){var t=musicList.length,a=musicIndex;"prev"==e?1==a?a=t:a-=1:("next"==e||"ended"==e)&&(a==t?a=1:a+=1),musicIndex=a,playIndex(a-1)}function playIndex(e){initPlayer(e),audio.load(),toPlay("play"),se.setItem("index",e+1)}function changePorgress(e,t){50>=t?(left.style.webkitTransform="rotate("+3.6*t+"deg)",right.style.opacity=0,mask.style.opacity=1):(right.style.opacity=1,mask.style.opacity=0,left.style.webkitTransform="rotate(180deg)",right.style.webkitTransform="rotate("+3.6*t+"deg)")}function hasClass(e,t){for(var n,a=e.className.split(" "),s=0;s<a.length;s++){if(a[s]==t){n=!0;break}n=!1}return n}function addClass(e,t){hasClass(e,t)||(e.className+=" "+t)}function removeClass(e,t){if(hasClass(e,t))for(var a=e.className.split(" "),n=0;n<a.length;n++)if(a[n]==t){a.splice(n,1),e.className=a.join(" ");break}}function replaceClass(e,t,a){if(hasClass(e,t))for(var n=e.className.split(" "),s=0;s<n.length;s++)if(n[s]==t){n.splice(s,1,a),e.className=t.join(" ");break}}function playMusic(e){toPlay("pause"),hasClass($("#music"),"hidden")&&removeClass($("#music"),"hidden"),audio.setAttribute("src",e.Source),$(".song").innerHTML=e.Title,$(".album").innerHTML=e.Album,$(".progress").style.width="0px",audio.removeEventListener("canplay",bufferBar,!1),clearInterval(bufferTimer),$(".buffer").style.width="0px"}function toTimestamp(e){var t=new Date(e);return Date.parse(t)}function getDateDiff(e){var t=6e4,a=60*t,n=24*a,r=30*n,o=365*n,i=Date.parse(new Date),l=i-e;if(!(0>l)){var c=l/o,d=l/r,u=l/(7*n),m=l/n,f=l/a,p=l/t;return c>=1?result=""+parseInt(c)+"年前":d>=1?result=""+parseInt(d)+"月前":u>=1?result=""+parseInt(u)+"周前":m>=1?result=""+parseInt(m)+"天前":f>=1?result=""+parseInt(f)+"小时前":p>=1?result=""+parseInt(p)+"分钟前":result="刚刚",result}}function simple_comment(e){var t=document.createElement("li");t.className="comment-li",t.dataset.thread=e.id,t.dataset.author=e.author.name;var a="",n="";return arguments.length>=2&&(a=arguments[1],n="<span> &nbsp;回复 "+a+"</span>"),t.innerHTML='<div class="comment-content"><div class="avatar"><img src="'+e.author.avatar.cache+'" alt=""></div><div class="comment-body"><header class="comment-header"><span class="author"><a href="'+e.author.profileUrl+'">'+e.author.name+"</a></span>"+n+'<span class="meta"><span class="bullet bullet-first">&nbsp;•&nbsp;</span>'+getDateDiff(toTimestamp(e.createdAt))+'<span class="bullet bullet-first">&nbsp;•&nbsp;</span><a href="javascript:void(0)" class="reply" onclick="reply('+e.id+')">回复</a></span></header><div class="comment-body-inner">'+e.message+'</div></div></div><ul class="children"></ul>',t}function reply(){var e="/disqus?link="+location.href;1==arguments.length&&(e+="&parent="+arguments[0]),window.open(e,"newwindow","height=500, width=400, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=n o, status=no")}function comment_render(e){for(var t=$(".comment .comment-posts"),a=e.length-1;a>=0;a--)if(null==e[a].parent){var n=simple_comment(e[a]);t.append(n)}else{var s=$('.comment .comment-posts li[data-thread="'+e[a].parent+'"]'),n=simple_comment(e[a],s.dataset.author,s.dataset.thread);s.childNodes[1].append(n)}var r=$.all(".comment .comment-posts>.comment-li");t.innerHTML="";for(var a=r.length-1;a>=0;a--)t.append(r[a])}function dropHandler(e){e.stopPropagation(),e.preventDefault();for(var n,t=e.dataTransfer.files,a=0;n=t[a];a++){var s=new FileReader;s.onload=function(e){return function(e){document.body.className="",localStorage.setItem("body__style","background:url("+this.result+") no-repeat fixed center/cover");var t=localStorage.getItem("body__style");document.body.style=t}}(n),s.readAsDataURL(n)}}function dragOverHandler(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dragEffect="copy"}var musicList=[{Artist:"Suara",Album:"「Pure -AQUAPLUS LEGEND OF ACOUSTICS-」",Source:"https://dn-wind-moe.qbox.me/static/music/Suara - 梦想歌.mp3?ver=1.0",Title:"梦想歌",Duration:"247"},{Artist:"Suara",Title:"不安定な神様",Album:"「不安定な神様」",Source:"https://dn-wind-moe.qbox.me/static/music/Suara - 不安定な神様.mp3",Duration:"244"}],se=sessionStorage,audio=$("#audio"),volumeTimer=null;audio.volume=.5,$(".play").onclick=function(){toPlay("play")},$(".pause").onclick=function(){toPlay("pause")},$(".prev").onclick=function(){toPlay("prev")},$(".next").onclick=function(){toPlay("next")},audio.addEventListener("ended",function(){playMusicMode("ended")},!1),audio.addEventListener("timeupdate",function(){if(!isNaN(audio.duration)){sessionStorage.setItem("current",audio.currentTime);var e=audio.currentTime/audio.duration*100;changePorgress($(".progress"),parseInt(e))}},!1);var circle=$(".circle"),mask=$(".mask"),left=$(".left"),right=$(".right");if(se.getItem("index"))var musicIndex=parseInt(se.getItem("index"));else{var musicIndex=1;se.setItem("index",musicIndex)}se.getItem("pause")&&0==se.getItem("pause")&&(setTimeout(function(){audio.play(),change()},150),addClass($(".play"),"hidden"),removeClass($(".pause"),"hidden")),Title=document.title,document.addEventListener("visibilitychange",function(){var e=["╭(′▽`)╯","( ͡° ͜ʖ ͡°)","(ÒܫÓױ)","ヽ( ^∀^)ﾉ","(╯°□°)╯︵","(´・ω・`)","(`皿´)","(¬_¬)",'(￣▽￣)"',"(〒︿〒)"];document.hidden?(document.title=e[parseInt(10*Math.random(),10)]+" "+document.title,clearTimeout(2e3)):document.title=Title}),document.onkeydown=function(e){if(e||(e=window.event),13==(e.keyCode||e.which)){if(0===$("#search-field").value.length)return!1;window.location.href="/?search="+$("#search-field").value}},window.onload=function(){function e(e){for(var t=e.offsetTop;e=e.offsetParent;)t+=e.offsetTop;return t}function n(){var n=$(".container").scrollTop;~function(){a+n+1e3>e(t)&&comment()}()}if("function"==typeof comment){var t=$("#disqus_thread"),a=window.innerHeight;$(".container").addEventListener("scroll",n),n()}document.styleSheets[1].addRule(".drawer-header","background-image: url(/static/img/kuon.png);"),0!==document.body.querySelectorAll(".lazyload").length&&$.img.lazyload(),initPlayer(musicIndex-1)},$("#top-btn").addEventListener("click",function(){function t(){var t=$(".container").scrollTop;return 0===t?void clearInterval(e):void($(".container").scrollTop=.8*t)}var e=setInterval(t,20);$["class"].has($("header"),"above")&&$["class"].remove($("header"),"above")}),$("#open-btn").addEventListener("click",function(){"float-btn-group"==$("#more").className?$("#more").className="float-btn-group open":($("#more").className="float-btn-group",$("#music-more").className="")}),$("#music-btn").addEventListener("click",function(){""==$("#music-more").className?$("#music-more").className="open":$("#music-more").className=""});var dialog=document.querySelector("dialog"),showDialogButton=document.querySelector("#show-dialog");dialog.showModal||dialogPolyfill.registerDialog(dialog),showDialogButton.addEventListener("click",function(){dialog.showModal(),$("#more").className="float-btn-group",$("#music-more").className=""}),dialog.querySelector(".close").addEventListener("click",function(){dialog.close()});var body=document.body;body.addEventListener("drop",dropHandler,!1),body.addEventListener("dragover",dragOverHandler,!1);var headerChange=function(e){e=e||window.event,e.wheelDelta&&(e.wheelDelta<0?addClass($("header.mdl-layout__header"),"above"):e.wheelDelta>0&&removeClass($("header.mdl-layout__header"),"above"))};$(".container").onmousewheel=headerChange;